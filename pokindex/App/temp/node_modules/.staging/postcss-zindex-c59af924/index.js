'use strict';

var postcss = require('postcss');

module.exports = postcss.plugin('postcss-zindex', function (opts) {
    opts = opts || {};
    return function (css) {
        var cache = require('./lib/layerCache')(opts);
        var nodes = [];
        var abort = false;
        // First pass; cache all z indexes
        css.walkDecls('z-index', function (decl) {
            // Check that no negative values exist. Rebasing is only
            // safe if all indices are positive numbers.
            if (d